# opencircom-hardhat-boilerplate

Minimal [Hardhat](https://hardhat.org/) project that compiles a Circom ZK circuit using [opencircom](https://www.npmjs.com/package/opencircom) and verifies a Groth16 proof on-chain.

## Prerequisites

- [Node.js](https://nodejs.org/) (v18+)
- [circom](https://docs.circom.io/getting-started/installation)

## Setup

```bash
npm install
```

## Commands

| Command | Description |
|--------|-------------|
| `npm run compile:circuits` | Compile `circuits/hello_hash.circom` (Poseidon hash) to R1CS and WASM in `build/`. |
| `npm run setup:zk` | Generate Powers of Tau, zkey, and Solidity verifier in `contracts/verifiers/HelloHashVerifier.sol`. |
| `npm run compile` | Compile circuits then Hardhat contracts. |
| `npm test` | Compile circuits, run ZK setup, compile contracts, then run Hardhat tests. |
| `npm run clean` | Remove `build/`, `cache/`, `artifacts/`, and generated verifier. Re-run `setup:zk` and `npm test` after cleaning. |

The first `npm test` runs the full ZK setup and can take about a minute.

## Layout

- `circuits/hello_hash.circom` — Example circuit using opencircom’s Poseidon.
- `scripts/compile_circuits.sh` — Compiles with `-l node_modules/opencircom/circuits`.
- `scripts/setup_zk.sh` — ptau, zkey, and verifier generation.
- `contracts/verifiers/HelloHashVerifier.sol` — Groth16 verifier (generated by `setup:zk`).
- `contracts/PoseidonProofGateway.sol` — Example contract that calls the verifier; stores last verified hash on successful `submitProof(...)`.
- `test/hello.test.js` — Generates a proof, verifies via the verifier and via the gateway contract (`submitProof` + `lastVerifiedHash`).

## License

MIT
